\documentclass[a4paper,12pt]{article}
\usepackage{mathtext}
\usepackage[T2A]{fontenc}
\usepackage[koi8-r]{inputenc}
\usepackage[russian]{babel}
\usepackage{array}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage[justification=centering]{caption}
\usepackage{indentfirst}
\usepackage[pdftex]{graphicx,color}
\usepackage{textcomp}
\usepackage{gnuplot-lua-tikz}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{fontogr}
\usepackage[top=25mm,bottom=25mm,left=30mm,right=15mm]{geometry}
% \usepackage{mathptm}



% \renewcommand{\captionlabeldelim} {.}

\makeatletter
\renewcommand\@biblabel[1]{#1.}
\makeatother

\unitlength=1mm

\usepackage{listings} %% собственно, это и есть пакет listings
% \usepackage{caption}
\DeclareCaptionFont{white}{\color{white}} %% это сделает текст заголовка белым
%% код ниже нарисует серую рамочку вокруг заголовка кода.
\DeclareCaptionFormat{listing}{\colorbox{white}{\parbox{\textwidth}{#1#2#3}}}
% \captionsetup[lstlisting]{format=listing,labelfont=black,textfont=black}
\renewcommand{\lstlistingname}{Листинг}


\begin{document}


\usetikzlibrary{arrows}

\lstset{ %
 language=Bash,                 % выбор языка для подсветки (здесь это С)
 basicstyle=\small\ttfamily, % размер и начертание шрифта для подсветки кода
 numbers=left,               % где поставить нумерацию строк (слева\справа)
 numberstyle=\tiny,           % размер шрифта для номеров строк
 stepnumber=1,                   % размер шага между двумя номерами строк
 numbersep=5pt,                % как далеко отстоят номера строк от
 % подсвечиваемого кода
 backgroundcolor=\color{white}, % цвет фона подсветки - используем
 showspaces=false,            % показывать или нет пробелы специальными
% отступами
 showstringspaces=false,      % показывать или нет пробелы в строках
 showtabs=false,             % показывать или нет табуляцию в строках
 frame=single,              % рисовать рамку вокруг кода
 tabsize=2,                 % размер табуляции по умолчанию равен 2 пробелам
 captionpos=t,              % позиция заголовка вверху [t] или внизу [b] 
 breaklines=true,           % автоматически переносить строки (да\нет)
% wordwrap=true,
 breakatwhitespace=false, % переносить строки только если есть пробел
 escapeinside={\%*}{*)}   % если нужно добавить комментарии в коде
 }

% \cygfamily

\author{Кузнецов В.В., ассистент кафедры ЭИУ1-КФ}
\title{Семинар \No 1 по курсу <<Основы цифровой обработки сигналов>> \\
Математическая модель сигнала}
\maketitle

\section{Цель работы}

Целью семинара является построение осциллограмм различных радиотехнических
сигналов на основе математической модели сигнала при помощи программы Gnuplot. 
 
\section{Введение в Gnuplot} 

Gnuplot предназначен для построения инженерных и научных
графиков и распространяется бесплатно. Программа работает под управлением ОС
Linux и Windows. Родной ОС для неё является Linux и на этой платформе Gnuplot
обладает наивысшей стабильностью и скоростью работы. Gnuplot входит во все
современные дистрибутивы Linux и его можно установить в один клик через
пакетный менеджер. Скачать установщик Gnuplot для Windows можно с официального
сайта \url{http://gnuplot.sourceforge.net/}. В данном руководстве использованы
материалы с сайта \url{http://mydebianblog.blogspot.com/}, где можно найти
дополнительную информацию по Gnuplot на русском языке.

Чтобы запустить Gnuplot после установки в системе Linux нужно набрать в
терминале \verb|gnuplot|, в Windows --- дважды щёлкнуть мышью по ярлыку,
который установщик создаёт на рабочем столе. После запуска Gnuplot переходит в
интерактивный режим и выдаёт следующее приглашение.

\begin{verbatim}
vvk@linux-bmx0:~> gnuplot
        G N U P L O T
        Version 4.6 patchlevel 0    last modified 2012-03-04 
        Build System: Linux x86_64

        Copyright (C) 1986-1993, 1998, 2004, 2007-2012
        Thomas Williams, Colin Kelley and many others

        gnuplot home:     http://www.gnuplot.info
        faq, bugs, etc:   type "help FAQ"
        immediate help:   type "help"  (plot window: hit 'h')

Terminal type set to 'qt'
gnuplot>
\end{verbatim}

Чтобы выйти из программы, нужно набрать команду \verb|quit| и нажать Enter.
Ввод любой команды в интерактивном режиме завершается нажатием на клавишу
Enter. В интерактивном режиме, чтобы строить графики нужно набрать команду. Для
построения графиков служит команда \verb|plot|. Если набрать после приглашения
Gnuplot \verb|plot sin(x)|, то откроется графическое окно, в котором будет
построен график синусоиды. По умолчанию Gnuplot строит графики на отрезке от
-10 до 10 и производит автоподгонку оси Y. Эти параметры в дальнейшем можно
построить. Строить графики в интерактивном режиме не очень удобно.


Но у gnuplot есть и другой режим работы - потоковый. Для освоения
и работы он более эффективен. Для того, чтобы быстро начать с ним работу и сразу
посмотреть, на что он способен, мы построим небольшой, но показательный график.
Всё, что нам потребуется - это любой текстовый редактор с подсветкой синтаксиса,
если нет никакого текстового редактора, то подойдёт даже обычный Notepad.
\textbf{Текстовые процессоры, подобные MS Word, LibreOffice и т.п. использовать
категорически \underline{запрещается}, так как они сохраняют файл в бинарный
формат!}

В потоковом режиме работы gnuplot воспринимает сразу все команды, которые вы ему
пошлёте, и сразу строит график по данным из файла. В ряде случае это удобнее, а
если требуется строить множество графиков, то потоковый режим работы Gnuplot вас
просто спасёт. Скрипты gnuplot можно генерировать автоматически и, например,
строить 100 графиков.

Итак, ниже приведём разбор построения типичного графика, параметры которого
записанного в виде скрипта, приведённого в листинге \ref{beispiel_data}. Пишите
в файл строчки так, как они написаны здесь, без переносов и абзацев - это
важно! За символом \verb|#| следует комментарий, в который можно писать всё, что
угодно.

\begin{lstlisting}[caption=Пример скрипта Gnuplot, label=beispiel_data]
#! /usr/bin/gnuplot -persist
# Далее выведем график в виде файла формата png. Primer.png
# Если нужно вывести график на экран, то закомментировать
# следующие две строки
set terminal png
set output "Primer.png" # Здесь для windows подставить полный путь к файлу
# Устанавливаем метки по оси Х 
set xlabel "Параметр регуляризациии" 
# Устанавливаем метки по оси Y
set ylabel "Величина СКО, отн.ед" 
# Устанавливаем предел значений по оси Y 
set yrange [0:1]
# Задаём стиль линии (line1): сплошная прямая(lt - от linetype) 
# с круглыми точками (pt - от pointstyle) типа 7 
set style line 1 lt 1 pt 7
#Теперь, задав все параметры, строим график, беря данные из файла Data.dat (для
# примера), где мы строим зависимость второго столбца от первого. Легенду для
# данных второго столбца называем СКО (среднеквадратичное отклонение) и
# заставляем строить график, используя тип линии, который мы задали. 
plot "Data.dat" using 1:2 title "СКО" with linespoints linestyle 1 
\end{lstlisting}



Создаём новый файл, называем, например, \verb|simple.plt| и начинаем в него
записывать команды Gnuplot. При сохранении файла нужно обязательно указать
кодировку UTF-8, а иначе \emph{русских букв не увидим}! Признаком того, что файл
относится к скрипту Gnuplot, является первая строка в файле.

Gnuplot может выводить графики не только в PNG-файлы, но и в форматы векторной
графики EPS, SVG, PDF. Те, кто пользуется системой \LaTeX, могут использовать
вывод в код \LaTeX или TikZ. Использование векторной графики является одним из
ключевых преимуществ Gnuplot. Чтобы изменить формат вывода, нужно поменять
строки 5 и 6 вышеприведённого листинга. В строку 6 нужно подставить имя файла с
правильным расширением, а в строке 5 --- указать формат файла, например 
\begin{verbatim}
 set terminal pdfcairo
\end{verbatim}
 Выведет график в формате PDF.


Осталось привести содержимое файла \verb|Data.dat| - это просто поток чисел,
разделённых пробелами (снятые параметры физического эксперимента):

\begin{verbatim}
1.0000000e+00 6.1881100e-01
2.0000000e+00 5.5289577e-01
3.0000000e+00 3.5527980e-01
4.0000000e+00 2.4352333e-01
5.0000000e+00 2.5852181e-01
6.0000000e+00 2.5291911e-01
8.0000000e+00 2.5109706e-01
1.0000000e+01 2.5524945e-01
1.2000000e+01 2.6013621e-01
1.3000000e+01 2.4596297e-01
\end{verbatim}

Этот файл тоже набирается в любом текстовом редакторе. 

Теперь, когда у нас есть всё необходимое для строительства графика, в командной
строке в ОС Linux пишем:
\begin{verbatim}
cat Primer.plt | gnuplot
\end{verbatim}

В системе Windows нужно запустить ярлык Gnuplot на рабочем столе и выбрать в
меню \verb|File->Open| наш скрипт.

Всё, должен появиться график Primer.png, который можно просмотреть любым
графическим редактором. Выглядеть он должен примерно так (см. рис.
\ref{graph-beispiel}):

\begin{figure}[|ht]
\begin{center}
\input{Primer.tex}
\end{center}
\caption{Пример графика}\label{graph-beispiel}
\end{figure}

Из этого примера видим, что Gnuplot в отличие от табличных процессоров,
подобных MS Excel и LibreOffice.Calc позволяет легко строить графики с
неравномерным распределением точек по оси Х.

Ну вот, мы и построили первый график в gnuplot. Gnuplot позволяет проводить и
некоторые вычисления в графиках. Доступны и математические функции, и переменные
с С-подобным синтаксисом. Например, чтобы в скрипте из листинга
\ref{beispiel_data} увеличить все значения по оси Y в три раза, нужно строку 20
модифицировать следующим образом:

\begin{verbatim}
plot "Data.dat" using 1:(3*$2) title "СКО" with linespoints linestyle 1
\end{verbatim}

А если напишем так:

\begin{verbatim}
plot "Data.dat" using 1:(exp(*$2)) title "СКО" with linespoints linestyle 1
\end{verbatim}

То Gnuplot вычислит экспоненту от второго столбца и выведет её на график.

При этом перед номером колонки из .dat - файла обязательно нужно поставить знак
\verb|$|.





\section{Математическая модель сигнала} 
 
Сигналом называют процесс изменения во времени физического
состояния какого-либо объекта, служащий для отображения, регистрации и передачи
сообщений. Сигналом могут быть например напряжение, ток, напряжённость поля. В
большинстве случаев носителями радиотехнических сигналов являются
электромагнитные колебания. Рассмотрим классификацию радиотехнических сигналов.

Математической моделью сигнала обычно служит функциональная зависимость,
аргументом которой является время. Например зависимость напряжения в цепи от
времени.

Если физический процесс, порождающий сигнал развивается во времени таким
образом, что его можно измерять в любые моменты времени, то сигнал такого
класса называется \emph{аналоговым}. Аналоговый сигнал можно наглядно
представить его графиком во времени --- осциллограммой. Осциллограмма может
быть непрерывной или иметь точки разрыва. 

Примером сигналов, широко применяемых в радиотехнике являются модулированные
сигналы. Модулированные сигналы применяются для передачи информации по
радиоканалу. Используются сигналы с амплитудной, частотной и фазовой модуляцией.

В амплитудно-модулированном (АМ) сигнале в такт с модулирующим сигналом
меняется амплитуда несущей. Математическая модель (зависимость уровня сигнала
от времени) для АМ-сигнала имеет вид:
\begin{equation}
 u(t)=U(t)\cos(\omega_0 t+\varphi_0)
\end{equation}

Где $U(t)$ --- огибающая;

При амплитудной модуляции связь между огибающей и модулирующим полезным
сигналом $s(t)$ выражается уравнением:
\begin{equation}
 U(t)=U_m[1+Ms(t)]
\end{equation}

Где $U_m$ --- амплитуда несущей в отсутствии модулирующего сигнала, $M$ ---
коэффициент амплитудной модуляции.

При частотной модуляции (ЧМ) амплитуда несущей остаётся неизменной, а в такт с
модулирующим сигналом изменяется частота несущей. ЧМ сигнал описывается
следующим уравнением (где $M$ --- индекс модуляции):

\begin{equation}
 u(t)=U_m\cos[(\omega_0+M s(t)) t]
\end{equation}

При фазовой модуляции (ФМ) в зависимости от амплитуды модулирующего сигнала
$s(t)$ меняется начальная фаза сигнала. ФМ сигнал описывается следующим
уравнением (где $M$ --- индекс модуляции).

\begin{equation}
 u(t)=U_m\cos(\omega_0 t+M s(t))
\end{equation}

В данные выражения везде входит круговая частота $\omega$, которая связана с
частотой $f$ как:
\begin{equation}
 \omega=2\pi f
\end{equation}


\section{Задание для выполнения}

В процессе выполнения семинара необходимо построить в программе Gnuplot
осциллограмы АМ, ЧМ и ФМ сигналов в соответствии с заданной частотой несущей
$f$, частотой модулирующего сигнала $f_m$ и коэффициентом модуляции $M$. Индекс
модуляции для ЧМ и ФМ подобрать по наилучшей наглядности получившейся
осциллограммы.

Исходные данные для выполнения задания приведены в таблице 1. 

\begin{table}[!ht]
\caption{Исходные данные}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\No варианта & $f$, Гц & $f_m$, Гц & $M$ \\
\hline
1 & 100000 & 10000 & 0.1 \\
\hline
2 & 120000 & 8000 & 0.2 \\
\hline
3 & 90000 & 6000 & 0.8 \\
\hline
4 & 100000 & 12000 & 0.3 \\
\hline
5 & 160000 & 11000 & 0.4 \\
\hline
6 & 180000 & 10000 & 0.75 \\
\hline
7 & 200000 & 9000 & 0.66 \\
\hline
8 & 110000 & 10000 & 1.2 \\
\hline
9 & 150000 & 10000 & 0.5 \\
\hline
10 & 160000 & 15000 & 0.8 \\
\hline
11 & 180000 & 12000 & 0.6 \\
\hline
12 & 220000 & 22000 & 0.66 \\
\hline
13 & 200000 & 20000 & 0.15 \\
\hline
14 & 220000 & 20000 & 1.1 \\
\hline
15 & 160000 & 18000 & 1.5 \\
\hline
\end{tabular}
\end{center}
\end{table}

Амплитуду сигналов везде принять равной 1 В.

Пример скрипта Gnuplot, для выполнения задания приведён в листинге
\ref{beispiel}. 

\begin{lstlisting}[caption=Пример скрипта Gnuplot для выполнения задания.,
label=beispiel]
#!/usr/bin/gnuplot -persist
# Задаём парамметры сигнала в виде перменных.
# Здесь нужно вписать свои параметры по вариантам.
M_AM=0.55 #коэффициент модуляции АМ - сигнала
M_FM=20000 #коэффициент модуляции ЧМ - сигнала
M_PM=1.5 #коэффициент модуляции ФМ - сигнала
f=200000 #частота несущей, Гц
fm=10000 #частота модулирующего сигнала, Гц
# задаём функции графики которых будем строить. Синтаксис -- как в языке С
s(x)=cos(2*pi*fm*x) #модулирующий сигнал, вместо переменной времени t
# используем переменную x
U(x)=1+M_AM*s(x) # огибающая 
U_RF(x)=cos(2*pi*f*x) # несущая
U_AM(x)=U(x)*U_RF(x) # АМ - сигнал
U_FM(x)=cos(2*pi*(f+M_FM*s(x))*x) # ЧМ - сигнал
U_PM(x)=cos(2*pi*f*x+M_PM*s(x)) # ФМ - сигнал
set multiplot layout 4,1 # разбиваем окно на 4 графика по вертикали и один 
# график по горизонтали
#set terminal png # раскомментировать эту строку если хотим чтобы график вывелся
# не на экран а в файл PNG. Ещё можно выводить график в файлы PDF,SVG,EPS
set xrange [0:200e-6] #отрезок времени по оси x 0 - 200 мксек
set yrange [-3:3] #растяжка по Y от -3 до 3
set xlabel "Время, сек" # Подпись оси Х
set format x "%.1e" # У чисел на оси Х оставить один знак после запятой
set ylabel "Напряжение, В" # Подпись по оси Y
set ytics 2 # Два деления по оси Х
#set output "1.png" # раскомментировать эту строку если хотим чтобы 
# график вывелся  не на экран а в файл PNG. 
# Ещё можно выводить график в файлы PDF,SVG,EPS
# График выведется в файл с именем 1.png в текущем каталоге
# set sample 1000 # Пользователям Windows раскомментировать эту строку
plot s(x) title "Огибающая" # строим график Огибающей. title задаёт легенду
plot U_AM(x) title "АМ сигнал" # строим график АМ-сигнала
plot U_FM(x) title "ЧМ сигнал" # строим график ЧМ-сигнала
plot U_PM(x) title "ФМ сигнал", U_RF(x) title "несущая" 
# Строим график ФМ сигнала и несущей 
# на одном графике. Функции график которых хотим построить указаны через запятую
\end{lstlisting}


Несмотря на то, что Gnuplot не имеет графического интерфейса пользователя,
пользоваться им очень просто.

Gnuplot может работать в интерактивном режиме и команды из скрипта можно
вводить прямо в консоль Gnuplot. Но удобнее заранее записать команды в скрипт и
затем передать этот скрипт Gnuplot'у.

Скрипт из листинга набирается в любом текстовом редакторе, который может
сохранять текст с кодировкой UTF-8 (Unicode). Подойдёт даже обычный Notepad. Не
следует использовать редактор Word и ему подобные офисные программы, так как он
сохраняет текст в бинарный формат. Из текстового редактора нужно сохранить
скрипт в текстовый файл, например с именем \verb|Sem1.plt|. Кодировку нужно
обязательно выбрать UTF-8 для избежания проблем с русскими буквами. Затем
пользователям Linux нужно сделать файл исполняемым и запустить его как
программу. Сделать эта можно как из консоли, так и в файловом менеджере. В
консоли для этого нужно выполнить следующие две команды:
\begin{verbatim}
chmod a+x Sem1.plt
./Sem1.plt 
\end{verbatim}

Первая команда устанавливает права на исполнения файла, а вторая запускает
скрипт. Первую команду нужно выполнить только один раз.

В системе Windows нужно запустить ярлык Gnuplot на рабочем столе и выбрать в
меню \verb|File->Open| наш скрипт. 

В результате выполнения скрипта появится окно с четырьмя графиками, или, если
мы раскомментируем строки 19 и 27, то графики автоматически сохранятся в файл
PNG с заданным именем.

\end{document}
